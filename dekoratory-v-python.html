<!DOCTYPE html>
<html lang="ru"
>
<head>
    <title>Декораторы в Python - Astro blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://stonedastronaut.github.io/dekoratory-v-python.html">

        <meta name="author" content="Petr Kalmykov" />
        <meta name="keywords" content="python,programming,habr" />
        <meta name="description" content="Никакой волшебно новой информации здесь не будет, скорее это самому себе объяснение, что за зверь такой декораторы в python. Т.к. в pyhton ф-ии являются объектами, то к ним можно применить шаблон проектирования декоратор. Сам шаблон я на момент написания этих строк не разбирал, посему тут может быть не совсем ..." />

        <meta property="og:site_name" content="Astro blog" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Декораторы в Python"/>
        <meta property="og:url" content="https://stonedastronaut.github.io/dekoratory-v-python.html"/>
        <meta property="og:description" content="Никакой волшебно новой информации здесь не будет, скорее это самому себе объяснение, что за зверь такой декораторы в python. Т.к. в pyhton ф-ии являются объектами, то к ним можно применить шаблон проектирования декоратор. Сам шаблон я на момент написания этих строк не разбирал, посему тут может быть не совсем ..."/>
        <meta property="article:published_time" content="2015-08-19" />
            <meta property="article:section" content="misc" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="programming" />
            <meta property="article:tag" content="habr" />
            <meta property="article:author" content="Petr Kalmykov" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://stonedastronaut.github.io/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://stonedastronaut.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://stonedastronaut.github.io/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stonedastronaut.github.io/theme/css/style.css" type="text/css"/>

        <link href="https://stonedastronaut.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Astro blog ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://stonedastronaut.github.io/" class="navbar-brand">
Astro blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="https://stonedastronaut.github.io/pages/o-saite.html">
                             О сайте
                          </a></li>
                        <li class="active">
                            <a href="https://stonedastronaut.github.io/category/misc.html">Misc</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://stonedastronaut.github.io/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://stonedastronaut.github.io/dekoratory-v-python.html"
                       rel="bookmark"
                       title="Permalink to Декораторы в Python">
                        Декораторы в Python
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-08-19T00:47:00+06:00"> Wed 19 August 2015</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="https://stonedastronaut.github.io/tag/python.html">python</a>
        /
	<a href="https://stonedastronaut.github.io/tag/programming.html">programming</a>
        /
	<a href="https://stonedastronaut.github.io/tag/habr.html">habr</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Никакой волшебно новой информации здесь не будет, скорее это самому себе объяснение, что за зверь такой декораторы в python.</p>
<p>Т.к. в pyhton ф-ии являются объектами, то к ним можно применить шаблон проектирования <a href="https://ru.wikipedia.org/wiki/%D0%94%D0%B5%D0%BA%D0%BE%D1%80%D0%B0%D1%82%D0%BE%D1%80_%28%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD_%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%29">декоратор</a>. Сам шаблон я на момент написания этих строк не разбирал, посему тут может быть не совсем корректная информация о том насколько правильно реализуется данный шаблон в случае ф-ий языка python.</p>
<p>Итак. Декоратор - это возможность расширения ф-нала имеющейся ф-ии(объекта). Получается что-то типа наследования, но без создания новой сущности. Для реализации декораторов необходимо написать сам декоратор, это ф-ия которая принимает в качестве параметра другую ф-ю(именно её адрес, а не её вызов) и оборачивает её како-либо логикой. Например:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">some_func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">():</span>
        <span class="c"># делаем что-то перед вызовом оборачиваемой ф-ии</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;before&quot;</span><span class="p">)</span>
        <span class="c"># вызываем оборачиваемую ф-ю</span>
        <span class="n">some_func</span><span class="p">()</span>
        <span class="c"># делаем что-то после вызова обернутой ф-ии</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;after&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="k">def</span> <span class="nf">just_func</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Я не изменюсь, но меня можно обернуть&quot;</span><span class="p">)</span>
</pre></div>


<p>теперь обернем just_func</p>
<div class="highlight"><pre><span class="n">decorator</span><span class="p">(</span><span class="n">just_func</span><span class="p">)()</span>

<span class="c"># before</span>
<span class="c"># Я не изменюсь, но меня можно обернуть</span>
<span class="c"># after</span>
</pre></div>


<p>Можно подобному вызову ф-ии присовить имя:</p>
<div class="highlight"><pre><span class="n">just_func_wrapped</span> <span class="o">=</span> <span class="n">decorator</span><span class="p">(</span><span class="n">just_func</span><span class="p">)</span>
</pre></div>


<p>И при вызове <code>just_func_wrapped</code> получим тоже самое:</p>
<div class="highlight"><pre><span class="n">just_func_wrapped</span><span class="p">()</span>

<span class="c"># before</span>
<span class="c"># Я не изменюсь, но меня можно обернуть</span>
<span class="c"># after</span>
</pre></div>


<p>Мы почти добрались до сути. Собственно как это можно было записать при помощи синтаксиса декораторов:</p>
<div class="highlight"><pre><span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">just_func</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Я обернутая ф-я&quot;</span><span class="p">)</span>
</pre></div>


<p>И вызвав <code>just_func</code> получим:</p>
<div class="highlight"><pre><span class="n">just_func</span><span class="p">()</span>

<span class="c"># before</span>
<span class="c"># Я обернутая ф-я</span>
<span class="c"># after</span>
</pre></div>


<p>Т.е. синтаксис декоторов это синтаксический сахар заменяющий такую конструкцию:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">just_func</span><span class="p">():</span>
    <span class="k">pass</span>
<span class="n">just_func</span> <span class="o">=</span> <span class="n">decorator</span><span class="p">(</span><span class="n">just_func</span><span class="p">)</span>

<span class="c"># равносильно такой записи</span>
<span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">just_func</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>


<h2>Передача аргументов внутрь обертки</h2>
<p>Также можно, а точнее это и нужно, передавать агрументы внутрь ф-ии декоратора, оборачиваемой ф-ии.</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">just_func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;before&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Я получил внутрь аргументы &quot;</span> <span class="o">+</span> <span class="n">arg1</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">arg2</span><span class="p">)</span>
        <span class="c"># вызываем ф-ию с аргументами</span>
        <span class="n">just_func</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;after&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">just_func</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">str2</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">str1</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">str2</span><span class="p">)</span>

<span class="n">just_func</span><span class="p">(</span><span class="s">&quot;Привет&quot;</span><span class="p">,</span> <span class="s">&quot;Мир&quot;</span><span class="p">)</span>

<span class="c"># before</span>
<span class="c"># Я получил внутрь аргументы Привет Мир</span>
<span class="c"># Привет Мир</span>
<span class="c"># after</span>
</pre></div>


<h2>Декор методов в классах</h2>
<p>Всё то же самое за исключением, что метод отличается от ф-ии тем, что первым аргументом метода, всегда является ссылка на свой класс.</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">class_method</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">some</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Это обёртка для метода класса&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">some</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">class_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">some</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="nd">@decorator</span>
    <span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">some</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">+</span> <span class="n">some</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">my_method</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># 1003</span>
<span class="c"># Хотя по-идее мы могли бы ожидать 1 + 2, но благодаря обертке мы смогли</span>
<span class="c"># изменить функционал</span>
</pre></div>


<h2>Передача *args и **kwargs декорируемой ф-ии</h2>
<p>Ничего волшебного:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">just_func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">just_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">just_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">just_func</span><span class="p">()</span>

<span class="c"># ()</span>
<span class="c"># {}</span>
</pre></div>


<h2>Передача аргументов декоратору</h2>
<p>Логично возникает вопрос: "А как же передать аргументы в декоратор, если декоратор по определению должен принимать на вход только имя декорируемой ф-ии?".</p>
<p>Решение есть, но не лёгкое. Задекорируем декоратор (crazy).</p>
<div class="highlight"><pre><span class="c"># ф-ия создающая декоратор</span>
<span class="k">def</span> <span class="nf">decorator_for_decorator</span><span class="p">():</span>
    <span class="c"># ф-я декоратор (т.е. изменяющая ф-ал оборачиваемой ф-ии)</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="c"># ф-ия обертка</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">():</span>
            <span class="c"># some logic</span>
            <span class="n">func</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">wrapper</span>
    <span class="k">return</span> <span class="n">decorator</span>

<span class="n">new_decorator</span> <span class="o">=</span> <span class="n">decorator_for_decorator</span><span class="p">()</span>
<span class="c"># создаем декоратор и присваиваем его переменной</span>

<span class="k">def</span> <span class="nf">just_func</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Я просто ф-я&quot;</span><span class="p">)</span>

<span class="c"># задекорируем ф-ю</span>
<span class="n">just_func</span> <span class="o">=</span> <span class="n">new_decorator</span><span class="p">(</span><span class="n">just_func</span><span class="p">)</span>

<span class="c"># и теперь можем вызвать задекорированную ф-ю</span>
<span class="n">just_func</span><span class="p">()</span>
</pre></div>


<p>Или можно записать так:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">just_func</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;я декорируемая ф-я&quot;</span><span class="p">)</span>

<span class="n">just_func</span> <span class="o">=</span> <span class="n">decorator</span><span class="p">()(</span><span class="n">just_func</span><span class="p">)</span>

<span class="c"># и вызов задекорированной ф-ии</span>
<span class="n">just_func</span><span class="p">()</span>
</pre></div>


<p>А теперь то же самое, но только при помощи <code>@</code>:</p>
<div class="highlight"><pre><span class="nd">@decorator_for_decorator</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">just_func</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;я декорируемая ф-я&quot;</span><span class="p">)</span>

<span class="n">just_func</span><span class="p">()</span>
</pre></div>


<p>Т.к. декоратор теперь есть вызов ф-ии, то можем передать ему некие аргументы:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">deco_for_deco</span><span class="p">(</span><span class="n">deco_arg1</span><span class="p">,</span> <span class="n">deco_arg2</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">deco_arg1</span> <span class="o">+</span> <span class="n">deco_arg2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">just_func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">func_arg1</span><span class="p">,</span> <span class="n">func_arg2</span><span class="p">):</span>
            <span class="c"># данная обертка теперь имеет доступ как к аргументам</span>
            <span class="c"># декоратора, так и к аргументам декорируемой ф-ии</span>
            <span class="k">return</span> <span class="n">just_func</span><span class="p">(</span><span class="n">func_arg1</span><span class="p">,</span> <span class="n">func_arg2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span>
    <span class="k">return</span> <span class="n">decorator</span>

<span class="nd">@deco_for_deco</span><span class="p">(</span><span class="s">&quot;Привет&quot;</span><span class="p">,</span> <span class="s">&quot;Мир&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">just_func</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Меня задекорировали, и знаю только&quot;</span> <span class="o">+</span>\
            <span class="s">&quot;о своих аргументах </span><span class="si">%s</span><span class="s"> и </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">))</span>

<span class="c"># выведет: &quot;ПриветМир&quot;</span>

<span class="n">just_func</span><span class="p">(</span><span class="s">&quot;один&quot;</span><span class="p">,</span> <span class="s">&quot;два&quot;</span><span class="p">)</span>

<span class="c"># выведет: Меня задекорировали, и знаю только о своих аргументах один и два</span>
</pre></div>


<p>Зная всё что здесь написано можно сделать декоратор для декораторов которому можно передавать любые аргументы:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">deco_for_deco</span><span class="p">(</span><span class="n">decorataion_decorator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">decorator_maker</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">decorator_wrapper</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">decoration_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">decorator_wrapper</span>
    <span class="k">return</span> <span class="n">decorator_maker</span>
</pre></div>


<p>Теперь посмотрим как воспользоваться этой адовой смесью:</p>
<div class="highlight"><pre><span class="nd">@deco_for_deco</span>
<span class="k">def</span> <span class="nf">decorated_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">func_arg1</span><span class="p">,</span> <span class="n">func_arg2</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Я знаю о </span><span class="si">%s</span><span class="s"> и </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">func_arg1</span><span class="p">,</span> <span class="n">func_arg2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>


<p>Теперь декорируем нужные нам ф-ии передавая любые аргументы декоратору:</p>
<div class="highlight"><pre><span class="nd">@decorated_decorator</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">404</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">just_func</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Привет&quot;</span> <span class="o">+</span> <span class="n">arg1</span> <span class="o">+</span> <span class="n">arg2</span><span class="p">)</span>

<span class="n">just_func</span><span class="p">(</span><span class="s">&quot; Жвачка и &quot;</span><span class="p">,</span> <span class="s">&quot;Мир&quot;</span><span class="p">)</span>

<span class="c"># выведет:</span>
<span class="c"># Я знаю о (42, 404, 1024) и {}</span>
<span class="c"># Привет Жвачка и Мир</span>
</pre></div>


<h2>Подводя итоги</h2>
<p>В общем этот длиннопост переработанный изхабра, создавался когда я врубался в подсмотренный код в django, где в 4 строках скрыто целая тьма смысла и материала для изучения. Там создавался класс mixin в котором декорировался некий метод который обезапасивал доступ к сайту. Ацкая смесь без развернутых пояснений на англ. языке. Ну вот собственно с декораторами вроде разобрался.</p>
<p>Где еще применяется декорирование?</p>
<p>Декораторы могут быть использованы для расширения возможностей функций из сторонних библиотек (код которых мы не можем изменять), или для упрощения отладки (мы не хотим изменять код, который ещё не устоялся).
Так же полезно использовать декораторы для расширения различных функций одним и тем же кодом, без повторного его переписывания каждый раз, например:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">benchmark</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Декоратор, выводящий время, которое заняло</span>
<span class="sd">    выполнение декорируемой функции.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">time</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span>
        <span class="k">return</span> <span class="n">res</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="k">def</span> <span class="nf">logging</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Декоратор, логирующий работу кода.</span>
<span class="sd">    (хорошо, он просто выводит вызовы, но тут могло быть и логирование!)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>
        <span class="k">return</span> <span class="n">res</span>
    <span class="k">return</span> <span class="n">wrapper</span>


<span class="k">def</span> <span class="nf">counter</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Декоратор, считающий и выводящий количество вызовов</span>
<span class="sd">    декорируемой функции.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">wrapper</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;{0} была вызвана: {1}x&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
    <span class="n">wrapper</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">wrapper</span>


<span class="nd">@benchmark</span>
<span class="nd">@logging</span>
<span class="nd">@counter</span>
<span class="k">def</span> <span class="nf">reverse_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>

<span class="k">print</span> <span class="n">reverse_string</span><span class="p">(</span><span class="s">&quot;А роза упала на лапу Азора&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">reverse_string</span><span class="p">(</span><span class="s">&quot;A man, a plan, a canoe, pasta, heros, rajahs, a coloratura, maps, snipe, percale, macaroni, a gag, a banana bag, a tan, a tag, a banana bag again (or a camel), a crepe, pins, Spam, a rut, a Rolo, cash, a jar, sore hats, a peon, a canal: Panama!&quot;</span><span class="p">)</span>

<span class="c"># выведет:</span>
<span class="c"># reverse_string (&#39;А роза упала на лапу Азора&#39;,) {}</span>
<span class="c"># wrapper 0.0</span>
<span class="c"># reverse_string была вызвана: 1x</span>
<span class="c"># арозА упал ан алапу азор А</span>
<span class="c"># reverse_string (&#39;A man, a plan, a canoe, pasta, heros, rajahs, a coloratura, maps, snipe, percale, macaroni, a gag, a banana bag, a tan, a tag, a banana bag again (or a camel), a crepe, pins, Spam, a rut, a Rolo, cash, a jar, sore hats, a peon, a canal: Panama!&#39;,) {}</span>
<span class="c"># wrapper 0.0</span>
<span class="c"># reverse_string была вызвана: 2x</span>
<span class="c"># !amanaP :lanac a ,noep a ,stah eros ,raj a ,hsac ,oloR a ,tur a ,mapS ,snip ,eperc a ,)lemac a ro( niaga gab ananab a ,gat a ,nat a ,gab ananab a ,gag a ,inoracam ,elacrep ,epins ,spam ,arutaroloc a ,shajar ,soreh ,atsap ,eonac a ,nalp a ,nam A</span>
</pre></div>


<hr />
<p>Скопипащенно <em>©<a href="http://habrahabr.ru/post/141411/">отсюда</a></em></p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/StonedAstronaut"><i class="fa fa-github-square fa-lg"></i> github</a></li>
                <li class="list-group-item"><a href="https://plus.google.com/u/0/113483139834962824849/posts"><i class="fa fa-google-plus-square fa-lg"></i> google-plus</a></li>
              </ul>
            </li>



            <li class="list-group-item"><a href="https://stonedastronaut.github.io/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group " id="tags">
                </ul>
            </li>
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://getpelican.com/" target="_blank">
                Pelican
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://python.org/" target="_blank">
                Python.org
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://jinja.pocoo.org/" target="_blank">
                Jinja2
            </a>
        </li>
        <li class="list-group-item">
            <a href="#" target="_blank">
                You can modify those links in your config file
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Petr Kalmykov
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://stonedastronaut.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://stonedastronaut.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://stonedastronaut.github.io/theme/js/respond.min.js"></script>


</body>
</html>