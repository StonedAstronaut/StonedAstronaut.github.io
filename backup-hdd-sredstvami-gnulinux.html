<!DOCTYPE html>
<html lang="ru">
<head>
	<link rel="stylesheet" type="text/css" href="https://stonedastronaut.github.io/theme/css/style.css">
	<!--<link rel="stylesheet/less" type="text/css" href="/theme/css/style.less">-->
	<!--<script src="/theme/js/less.js" type="text/javascript"></script>-->
	<link rel="stylesheet" type="text/css" href="https://stonedastronaut.github.io/theme/css/pygments.css">
	<link href='//fonts.googleapis.com/css?family=Open+Sans:800,400,300|Inconsolata' rel='stylesheet' type='text/css'>

	<link href="https://stonedastronaut.github.io/" type="application/atom+xml" rel="alternate" title="Astro blog ATOM Feed" />


		<title>Astro blog</title>
		<meta charset="utf-8" />
</head>
<body>
	<section id="sidebar">
		<figure id="user_logo">
            <a href="https://stonedastronaut.github.io"><div class="logo">&nbsp;</div></a>
		</figure>

		<div class="user_meta">
            <h1 id="user"><a href="https://stonedastronaut.github.io" class="">Petr Kalmykov</a></h1>
			<h2></h2>
			<ul>
						<li><a href="https://stonedastronaut.github.io/pages/about.html">About</a></li>
					<li><a href="http://getpelican.com/">Pelican</a></li>
					<li><a href="http://python.org/">Python.org</a></li>
					<li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
					<li><a href="#">You can modify those links in your config file</a></li>
			</ul>
		</div>
		<footer>
			<address>
				Powered by <a href="http://pelican.notmyidea.org/">Pelican</a>,
		                theme by <a href="https://github.com/wting/pelican-svbtle">wting</a>.
			</address>
		</footer>
	</section>

	<section id="posts">
	<header>
		<h1>Petr Kalmykov's blog</h1>
		<h3>Posted Mon 09 February 2015</h3>
	</header>
	<article>
		<h1 id="title">
			<a href="https://stonedastronaut.github.io/backup-hdd-sredstvami-gnulinux.html" rel="bookmark"
				title="Permalink to Backup hdd средствами GNU/Linux">Backup hdd средствами GNU/Linux</a>
		</h1>
		<p>После теста hdd можно определить, пора ли менять диск или нет.</p>
<p>Если время пришло, то тогда необходимо перенести со старого жесткого всю инфу на новый.</p>
<p>Из гуглежа, стало ясно, чо использование обычного dd не "кошегно". Ъ использовать <strong>GNU ddrescue</strong>. Команда для backup'а выглядит следующим образом:</p>
<div class="highlight"><pre><span class="c"># ddrescue /dev/sdX /pth_to_backup/disk.img /pth_to_backup/disk.img.log</span>
</pre></div>


<p>Можно делать backup как раздела, так и всего hdd.</p>
<p>Для просмотра содержимого <strong>раздела</strong> используем следующую команду:</p>
<div class="highlight"><pre><span class="c"># mount -o loop /pth_to_backup/drive.img /mnt</span>
</pre></div>


<p>А для <strong>образа физического диска</strong>:</p>
<div class="highlight"><pre><span class="c"># losetup --partscan /dev/loop0 drive.img</span>
<span class="c"># mount /dev/loop0p2 /mnt</span>
</pre></div>


<p>или,</p>
<div class="highlight"><pre><span class="c"># kpartx -a /dev/loop0 drive.img</span>
<span class="c"># mount /dev/mapper/loop0p2 /mnt</span>
</pre></div>


<p>в зависимости от дистра.</p>
<p>Восстановление из образа:</p>
<div class="highlight"><pre><span class="c"># ddrescue --force disk.img /dev/sdxX disk.img.log</span>
</pre></div>


<p>!!!<strong>раздел на который идет восстановление должен быть <em>НЕ</em> меньше файла-образа</strong></p>
<p>стырено <a href="http://habrahabr.ru/post/233961/">изхабра</a></p>

		<div id="article_meta">
				Category:
					<a href="https://stonedastronaut.github.io/category/misc.html">misc</a>
				<br />Tags:
					<a href="https://stonedastronaut.github.io/tag/habr.html">habr</a>
					<a href="https://stonedastronaut.github.io/tag/linux.html">linux</a>
					<a href="https://stonedastronaut.github.io/tag/backup.html">backup</a>
		</div>
	</article>

	<footer>
		<a href="https://stonedastronaut.github.io/" class="button_accent">&larr;&nbsp;&nbsp;&nbsp;Back to blog</a>
	</footer>


	</section>

</body>
</html>