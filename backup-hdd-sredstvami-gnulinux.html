<!DOCTYPE html>
<html lang="ru">

<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="https://stonedastronaut.github.io/backup-hdd-sredstvami-gnulinux.html" />

    <title>  Astro blog &mdash; Backup hdd средствами GNU/Linux
</title>




    <link rel="stylesheet" href="https://stonedastronaut.github.io/theme/css/style.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <meta name="author" content="Petr Kalmykov">
    <meta name="description" content="После теста hdd можно определить, пора ли менять диск или нет. Если время пришло, то тогда необходимо перенести со старого жесткого всю инфу на новый. Из гуглежа, стало ясно, чо использование обычного dd не "кошегно". Ъ использовать GNU ddrescue. Команда для backup'а выглядит следующим образом: # ddrescue /dev/sdX /pth_to_backup ...">
  <meta name="tags" contents="habr, linux, backup, ">
</head>

<body>
<header class="header">
  <div class="container">
    <div class="header-inner">
      <h1 class="header-name">
        <a class="nodec" href="https://stonedastronaut.github.io">Astro blog</a>
      </h1>
      <h3 class="header-text"></h3>
      <ul class="header-menu list-inline">
      </ul>
    </div>
  </div>
</header> <!-- /.header -->  <div class="container">
  <div class="post full-post">
    <h1 class="post-title">
      <a href="/backup-hdd-sredstvami-gnulinux.html" title="Permalink to Backup hdd средствами GNU/Linux">Backup hdd средствами GNU/Linux</a>
    </h1>
    <ul class="list-inline">
      <li class="post-date">
        <a class="text-muted" href="/backup-hdd-sredstvami-gnulinux.html" title="2015-02-09T19:30:00+06:00">Mon 09 February 2015</a>
      </li>
      <li class="muted">&middot;</li>
      <li class="post-category">
        <a href="https://stonedastronaut.github.io/category/misc.html">misc</a>
      </li>
        <li class="muted">&middot;</li>
        <li>
            <a href="/tag/habr.html">habr</a>,             <a href="/tag/linux.html">linux</a>,             <a href="/tag/backup.html">backup</a>        </li>
    </ul>
    <div class="post-content">
      <p>После теста hdd можно определить, пора ли менять диск или нет.</p>
<p>Если время пришло, то тогда необходимо перенести со старого жесткого всю инфу на новый.</p>
<p>Из гуглежа, стало ясно, чо использование обычного dd не "кошегно". Ъ использовать <strong>GNU ddrescue</strong>. Команда для backup'а выглядит следующим образом:</p>
<div class="highlight"><pre><span class="c"># ddrescue /dev/sdX /pth_to_backup/disk.img /pth_to_backup/disk.img.log</span>
</pre></div>


<p>Можно делать backup как раздела, так и всего hdd.</p>
<p>Для просмотра содержимого <strong>раздела</strong> используем следующую команду:</p>
<div class="highlight"><pre><span class="c"># mount -o loop /pth_to_backup/drive.img /mnt</span>
</pre></div>


<p>А для <strong>образа физического диска</strong>:</p>
<div class="highlight"><pre><span class="c"># losetup --partscan /dev/loop0 drive.img</span>
<span class="c"># mount /dev/loop0p2 /mnt</span>
</pre></div>


<p>или,</p>
<div class="highlight"><pre><span class="c"># kpartx -a /dev/loop0 drive.img</span>
<span class="c"># mount /dev/mapper/loop0p2 /mnt</span>
</pre></div>


<p>в зависимости от дистра.</p>
<p>Восстановление из образа:</p>
<div class="highlight"><pre><span class="c"># ddrescue --force disk.img /dev/sdxX disk.img.log</span>
</pre></div>


<p>!!!<strong>раздел на который идет восстановление должен быть <em>НЕ</em> меньше файла-образа</strong></p>
<p>стырено <a href="http://habrahabr.ru/post/233961/">изхабра</a></p>
    </div>
  </div>
  <hr class="separator">
  <div class="col-md-8 col-md-offset-2">
  </div>
  </div>
<footer class="footer">
  <div class="container">
    <p class="text-center">
      Petr Kalmykov, <a href="" target="_blank"></a> unless otherwise noted.
    </p>
    <div class="text-center">
      Generated by <a href="http://getpelican.com" target="_blank">Pelican</a> with the <a href="http://github.com/nairobilug/pelican-alchemy">alchemy</a> theme.
    </div>
  </div>
</footer> <!-- /.footer -->
  <script src="https://stonedastronaut.github.io/theme/js/jquery.min.js"></script>
  <script src="https://stonedastronaut.github.io/theme/js/bootstrap.min.js"></script>
</body> <!-- 42 -->

</html>